\hypertarget{async__server_8c}{}\doxysection{/home/robert/\+Projects/http\+\_\+in\+\_\+c/http\+\_\+in\+\_\+c/async-\/old/async\+\_\+server.c File Reference}
\label{async__server_8c}\index{/home/robert/Projects/http\_in\_c/http\_in\_c/async-\/old/async\_server.c@{/home/robert/Projects/http\_in\_c/http\_in\_c/async-\/old/async\_server.c}}
{\ttfamily \#include $<$http\+\_\+in\+\_\+c/async/async.\+h$>$}\newline
{\ttfamily \#include $<$stdlib.\+h$>$}\newline
{\ttfamily \#include $<$stdio.\+h$>$}\newline
{\ttfamily \#include $<$unistd.\+h$>$}\newline
{\ttfamily \#include $<$assert.\+h$>$}\newline
{\ttfamily \#include $<$errno.\+h$>$}\newline
{\ttfamily \#include $<$fcntl.\+h$>$}\newline
{\ttfamily \#include $<$sys/epoll.\+h$>$}\newline
{\ttfamily \#include $<$rbl/logger.\+h$>$}\newline
{\ttfamily \#include $<$rbl/macros.\+h$>$}\newline
{\ttfamily \#include $<$http\+\_\+in\+\_\+c/common/alloc.\+h$>$}\newline
{\ttfamily \#include $<$http\+\_\+in\+\_\+c/common/utils.\+h$>$}\newline
{\ttfamily \#include \char`\"{}./async\+\_\+socket.\+h\char`\"{}}\newline
\doxysubsection*{Functions}
\begin{DoxyCompactItemize}
\item 
\mbox{\hyperlink{rl__internal_8h_a691e4d5de4b427a20b12e6a256b5406e}{void}} \mbox{\hyperlink{async__server_8c_acce4f1055b4731115967b73d8326273d}{on\+\_\+event\+\_\+listening}} (\mbox{\hyperlink{group__runloop_ga3be36d97cf9a7f7b4180b71d95cde72e}{Runloop\+Ref}} rl, \mbox{\hyperlink{rl__internal_8h_a691e4d5de4b427a20b12e6a256b5406e}{void}} $\ast$server\+\_\+ref\+\_\+arg)
\item 
static \mbox{\hyperlink{rl__internal_8h_a691e4d5de4b427a20b12e6a256b5406e}{void}} \mbox{\hyperlink{async__server_8c_a04b288950bb335f7a477d767fbf0dc18}{on\+\_\+handler\+\_\+completion\+\_\+cb}} (\mbox{\hyperlink{async_8h_aa2dffdb66273f9a25f9e23ca2d2a93fb}{Async\+Server\+Ref}} sref, \mbox{\hyperlink{async_8h_a0c7b3ab54cddeb06a3d86747fccf08e3}{Async\+Handler\+Ref}} handler\+\_\+ref)
\item 
\mbox{\hyperlink{rl__internal_8h_a691e4d5de4b427a20b12e6a256b5406e}{void}} \mbox{\hyperlink{async__server_8c_aa7d7db3c48fec3579141e8b4b6c42034}{Async\+Server\+\_\+init\+\_\+with\+\_\+socket}} (\mbox{\hyperlink{async_8h_aa2dffdb66273f9a25f9e23ca2d2a93fb}{Async\+Server\+Ref}} sref, int port, const char $\ast$host, int listen\+\_\+socket, \mbox{\hyperlink{async_8h_acd39035147bdfa4d30a1c5e6dc9db037}{Async\+Process\+Request\+Function}} process\+\_\+request)
\item 
\mbox{\hyperlink{rl__internal_8h_a691e4d5de4b427a20b12e6a256b5406e}{void}} \mbox{\hyperlink{async__server_8c_ac50ab496b70f85d920474a51c7e93355}{Async\+Server\+\_\+init}} (\mbox{\hyperlink{async_8h_aa2dffdb66273f9a25f9e23ca2d2a93fb}{Async\+Server\+Ref}} sref, int port\+\_\+number, const char $\ast$host, \mbox{\hyperlink{async_8h_acd39035147bdfa4d30a1c5e6dc9db037}{Async\+Process\+Request\+Function}} process\+\_\+request)
\item 
\mbox{\hyperlink{async_8h_aa2dffdb66273f9a25f9e23ca2d2a93fb}{Async\+Server\+Ref}} \mbox{\hyperlink{async__server_8c_a660813c4292b4a7f2efd8c08699ac222}{Async\+Server\+\_\+new\+\_\+with\+\_\+socket}} (int port, const char $\ast$host, int listen\+\_\+socket, \mbox{\hyperlink{async_8h_acd39035147bdfa4d30a1c5e6dc9db037}{Async\+Process\+Request\+Function}} process\+\_\+request)
\item 
\mbox{\hyperlink{async_8h_aa2dffdb66273f9a25f9e23ca2d2a93fb}{Async\+Server\+Ref}} \mbox{\hyperlink{async__server_8c_a8319a8492aa683fa4adaba02cd0f0ca4}{Async\+Server\+\_\+new}} (int port, const char $\ast$host, \mbox{\hyperlink{async_8h_acd39035147bdfa4d30a1c5e6dc9db037}{Async\+Process\+Request\+Function}} process\+\_\+request)
\item 
\mbox{\hyperlink{rl__internal_8h_a691e4d5de4b427a20b12e6a256b5406e}{void}} \mbox{\hyperlink{async__server_8c_a6e48205e38fd567afa94de2c4f7bffce}{Async\+Server\+\_\+destroy}} (\mbox{\hyperlink{async_8h_aa2dffdb66273f9a25f9e23ca2d2a93fb}{Async\+Server\+Ref}} this)
\item 
\mbox{\hyperlink{rl__internal_8h_a691e4d5de4b427a20b12e6a256b5406e}{void}} \mbox{\hyperlink{async__server_8c_ae9d91cfd6c1d8eb2fd0f3ea15b2b9a66}{Async\+Server\+\_\+free}} (\mbox{\hyperlink{async_8h_aa2dffdb66273f9a25f9e23ca2d2a93fb}{Async\+Server\+Ref}} this)
\item 
\mbox{\hyperlink{rl__internal_8h_a691e4d5de4b427a20b12e6a256b5406e}{void}} \mbox{\hyperlink{async__server_8c_aab71f6ef59ea9f8f907f984b0de57939}{Async\+Server\+\_\+dispose}} (\mbox{\hyperlink{async_8h_aa2dffdb66273f9a25f9e23ca2d2a93fb}{Async\+Server\+Ref}} $\ast$sref)
\item 
\mbox{\hyperlink{rl__internal_8h_a691e4d5de4b427a20b12e6a256b5406e}{void}} \mbox{\hyperlink{async__server_8c_a8948cfb570b5c25e244e75142398a83a}{Async\+Server\+\_\+start}} (\mbox{\hyperlink{async_8h_aa2dffdb66273f9a25f9e23ca2d2a93fb}{Async\+Server\+Ref}} sref)
\item 
\mbox{\hyperlink{rl__internal_8h_a691e4d5de4b427a20b12e6a256b5406e}{void}} \mbox{\hyperlink{async__server_8c_a73cce7982d157275c8b73475a57d7f4f}{Demo\+Server\+\_\+terminate}} (\mbox{\hyperlink{async_8h_aa2dffdb66273f9a25f9e23ca2d2a93fb}{Async\+Server\+Ref}} this)
\end{DoxyCompactItemize}


\doxysubsection{Function Documentation}
\mbox{\Hypertarget{async__server_8c_a6e48205e38fd567afa94de2c4f7bffce}\label{async__server_8c_a6e48205e38fd567afa94de2c4f7bffce}} 
\index{async\_server.c@{async\_server.c}!AsyncServer\_destroy@{AsyncServer\_destroy}}
\index{AsyncServer\_destroy@{AsyncServer\_destroy}!async\_server.c@{async\_server.c}}
\doxysubsubsection{\texorpdfstring{AsyncServer\_destroy()}{AsyncServer\_destroy()}}
{\footnotesize\ttfamily \mbox{\hyperlink{rl__internal_8h_a691e4d5de4b427a20b12e6a256b5406e}{void}} Async\+Server\+\_\+destroy (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{async_8h_aa2dffdb66273f9a25f9e23ca2d2a93fb}{Async\+Server\+Ref}}}]{this }\end{DoxyParamCaption})}

\mbox{\Hypertarget{async__server_8c_aab71f6ef59ea9f8f907f984b0de57939}\label{async__server_8c_aab71f6ef59ea9f8f907f984b0de57939}} 
\index{async\_server.c@{async\_server.c}!AsyncServer\_dispose@{AsyncServer\_dispose}}
\index{AsyncServer\_dispose@{AsyncServer\_dispose}!async\_server.c@{async\_server.c}}
\doxysubsubsection{\texorpdfstring{AsyncServer\_dispose()}{AsyncServer\_dispose()}}
{\footnotesize\ttfamily \mbox{\hyperlink{rl__internal_8h_a691e4d5de4b427a20b12e6a256b5406e}{void}} Async\+Server\+\_\+dispose (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{async_8h_aa2dffdb66273f9a25f9e23ca2d2a93fb}{Async\+Server\+Ref}} $\ast$}]{sref }\end{DoxyParamCaption})}

\mbox{\Hypertarget{async__server_8c_ae9d91cfd6c1d8eb2fd0f3ea15b2b9a66}\label{async__server_8c_ae9d91cfd6c1d8eb2fd0f3ea15b2b9a66}} 
\index{async\_server.c@{async\_server.c}!AsyncServer\_free@{AsyncServer\_free}}
\index{AsyncServer\_free@{AsyncServer\_free}!async\_server.c@{async\_server.c}}
\doxysubsubsection{\texorpdfstring{AsyncServer\_free()}{AsyncServer\_free()}}
{\footnotesize\ttfamily \mbox{\hyperlink{rl__internal_8h_a691e4d5de4b427a20b12e6a256b5406e}{void}} Async\+Server\+\_\+free (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{async_8h_aa2dffdb66273f9a25f9e23ca2d2a93fb}{Async\+Server\+Ref}}}]{this }\end{DoxyParamCaption})}

\mbox{\Hypertarget{async__server_8c_ac50ab496b70f85d920474a51c7e93355}\label{async__server_8c_ac50ab496b70f85d920474a51c7e93355}} 
\index{async\_server.c@{async\_server.c}!AsyncServer\_init@{AsyncServer\_init}}
\index{AsyncServer\_init@{AsyncServer\_init}!async\_server.c@{async\_server.c}}
\doxysubsubsection{\texorpdfstring{AsyncServer\_init()}{AsyncServer\_init()}}
{\footnotesize\ttfamily \mbox{\hyperlink{rl__internal_8h_a691e4d5de4b427a20b12e6a256b5406e}{void}} Async\+Server\+\_\+init (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{async_8h_aa2dffdb66273f9a25f9e23ca2d2a93fb}{Async\+Server\+Ref}}}]{sref,  }\item[{int}]{port\+\_\+number,  }\item[{const char $\ast$}]{host,  }\item[{\mbox{\hyperlink{async_8h_acd39035147bdfa4d30a1c5e6dc9db037}{Async\+Process\+Request\+Function}}}]{process\+\_\+request }\end{DoxyParamCaption})}

\mbox{\Hypertarget{async__server_8c_aa7d7db3c48fec3579141e8b4b6c42034}\label{async__server_8c_aa7d7db3c48fec3579141e8b4b6c42034}} 
\index{async\_server.c@{async\_server.c}!AsyncServer\_init\_with\_socket@{AsyncServer\_init\_with\_socket}}
\index{AsyncServer\_init\_with\_socket@{AsyncServer\_init\_with\_socket}!async\_server.c@{async\_server.c}}
\doxysubsubsection{\texorpdfstring{AsyncServer\_init\_with\_socket()}{AsyncServer\_init\_with\_socket()}}
{\footnotesize\ttfamily \mbox{\hyperlink{rl__internal_8h_a691e4d5de4b427a20b12e6a256b5406e}{void}} Async\+Server\+\_\+init\+\_\+with\+\_\+socket (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{async_8h_aa2dffdb66273f9a25f9e23ca2d2a93fb}{Async\+Server\+Ref}}}]{sref,  }\item[{int}]{port,  }\item[{const char $\ast$}]{host,  }\item[{int}]{listen\+\_\+socket,  }\item[{\mbox{\hyperlink{async_8h_acd39035147bdfa4d30a1c5e6dc9db037}{Async\+Process\+Request\+Function}}}]{process\+\_\+request }\end{DoxyParamCaption})}

THe listen\+\_\+socket must be\+:
\begin{DoxyItemize}
\item created,
\item set REUSEADDR,
\item set REUSEPORT,
\item set Non Blocking,
\item bind() to port and host
\end{DoxyItemize}

BEFORE this call \mbox{\Hypertarget{async__server_8c_a8319a8492aa683fa4adaba02cd0f0ca4}\label{async__server_8c_a8319a8492aa683fa4adaba02cd0f0ca4}} 
\index{async\_server.c@{async\_server.c}!AsyncServer\_new@{AsyncServer\_new}}
\index{AsyncServer\_new@{AsyncServer\_new}!async\_server.c@{async\_server.c}}
\doxysubsubsection{\texorpdfstring{AsyncServer\_new()}{AsyncServer\_new()}}
{\footnotesize\ttfamily \mbox{\hyperlink{async_8h_aa2dffdb66273f9a25f9e23ca2d2a93fb}{Async\+Server\+Ref}} Async\+Server\+\_\+new (\begin{DoxyParamCaption}\item[{int}]{port,  }\item[{const char $\ast$}]{host,  }\item[{\mbox{\hyperlink{async_8h_acd39035147bdfa4d30a1c5e6dc9db037}{Async\+Process\+Request\+Function}}}]{process\+\_\+request }\end{DoxyParamCaption})}

\mbox{\Hypertarget{async__server_8c_a660813c4292b4a7f2efd8c08699ac222}\label{async__server_8c_a660813c4292b4a7f2efd8c08699ac222}} 
\index{async\_server.c@{async\_server.c}!AsyncServer\_new\_with\_socket@{AsyncServer\_new\_with\_socket}}
\index{AsyncServer\_new\_with\_socket@{AsyncServer\_new\_with\_socket}!async\_server.c@{async\_server.c}}
\doxysubsubsection{\texorpdfstring{AsyncServer\_new\_with\_socket()}{AsyncServer\_new\_with\_socket()}}
{\footnotesize\ttfamily \mbox{\hyperlink{async_8h_aa2dffdb66273f9a25f9e23ca2d2a93fb}{Async\+Server\+Ref}} Async\+Server\+\_\+new\+\_\+with\+\_\+socket (\begin{DoxyParamCaption}\item[{int}]{port,  }\item[{const char $\ast$}]{host,  }\item[{int}]{listen\+\_\+socket,  }\item[{\mbox{\hyperlink{async_8h_acd39035147bdfa4d30a1c5e6dc9db037}{Async\+Process\+Request\+Function}}}]{process\+\_\+request }\end{DoxyParamCaption})}

\mbox{\Hypertarget{async__server_8c_a8948cfb570b5c25e244e75142398a83a}\label{async__server_8c_a8948cfb570b5c25e244e75142398a83a}} 
\index{async\_server.c@{async\_server.c}!AsyncServer\_start@{AsyncServer\_start}}
\index{AsyncServer\_start@{AsyncServer\_start}!async\_server.c@{async\_server.c}}
\doxysubsubsection{\texorpdfstring{AsyncServer\_start()}{AsyncServer\_start()}}
{\footnotesize\ttfamily \mbox{\hyperlink{rl__internal_8h_a691e4d5de4b427a20b12e6a256b5406e}{void}} Async\+Server\+\_\+start (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{async_8h_aa2dffdb66273f9a25f9e23ca2d2a93fb}{Async\+Server\+Ref}}}]{sref }\end{DoxyParamCaption})}

\mbox{\Hypertarget{async__server_8c_a73cce7982d157275c8b73475a57d7f4f}\label{async__server_8c_a73cce7982d157275c8b73475a57d7f4f}} 
\index{async\_server.c@{async\_server.c}!DemoServer\_terminate@{DemoServer\_terminate}}
\index{DemoServer\_terminate@{DemoServer\_terminate}!async\_server.c@{async\_server.c}}
\doxysubsubsection{\texorpdfstring{DemoServer\_terminate()}{DemoServer\_terminate()}}
{\footnotesize\ttfamily \mbox{\hyperlink{rl__internal_8h_a691e4d5de4b427a20b12e6a256b5406e}{void}} Demo\+Server\+\_\+terminate (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{async_8h_aa2dffdb66273f9a25f9e23ca2d2a93fb}{Async\+Server\+Ref}}}]{this }\end{DoxyParamCaption})}

\mbox{\Hypertarget{async__server_8c_acce4f1055b4731115967b73d8326273d}\label{async__server_8c_acce4f1055b4731115967b73d8326273d}} 
\index{async\_server.c@{async\_server.c}!on\_event\_listening@{on\_event\_listening}}
\index{on\_event\_listening@{on\_event\_listening}!async\_server.c@{async\_server.c}}
\doxysubsubsection{\texorpdfstring{on\_event\_listening()}{on\_event\_listening()}}
{\footnotesize\ttfamily \mbox{\hyperlink{rl__internal_8h_a691e4d5de4b427a20b12e6a256b5406e}{void}} on\+\_\+event\+\_\+listening (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{group__runloop_ga3be36d97cf9a7f7b4180b71d95cde72e}{Runloop\+Ref}}}]{rl,  }\item[{\mbox{\hyperlink{rl__internal_8h_a691e4d5de4b427a20b12e6a256b5406e}{void}} $\ast$}]{server\+\_\+ref\+\_\+arg }\end{DoxyParamCaption})}

\mbox{\Hypertarget{async__server_8c_a04b288950bb335f7a477d767fbf0dc18}\label{async__server_8c_a04b288950bb335f7a477d767fbf0dc18}} 
\index{async\_server.c@{async\_server.c}!on\_handler\_completion\_cb@{on\_handler\_completion\_cb}}
\index{on\_handler\_completion\_cb@{on\_handler\_completion\_cb}!async\_server.c@{async\_server.c}}
\doxysubsubsection{\texorpdfstring{on\_handler\_completion\_cb()}{on\_handler\_completion\_cb()}}
{\footnotesize\ttfamily static \mbox{\hyperlink{rl__internal_8h_a691e4d5de4b427a20b12e6a256b5406e}{void}} on\+\_\+handler\+\_\+completion\+\_\+cb (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{async_8h_aa2dffdb66273f9a25f9e23ca2d2a93fb}{Async\+Server\+Ref}}}]{sref,  }\item[{\mbox{\hyperlink{async_8h_a0c7b3ab54cddeb06a3d86747fccf08e3}{Async\+Handler\+Ref}}}]{handler\+\_\+ref }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [static]}}

